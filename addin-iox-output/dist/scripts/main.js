"use strict";geotab.addin.ioxOutput=function(){var o,i,u,d,a,c,r,l=function(e){c.innerHTML=e},n=function(e){var t=e+"-"+Date.now(),n=document.createElement("h4"),i=document.createTextNode("Sent: "+new Date);n.setAttribute("id",t),n.appendChild(i),a.appendChild(n),function t(n){setTimeout(function(){o.call("Get",{typeName:"TextMessage",search:{id:n.split("-")[0]}},function(e){e[0].delivered?document.getElementById(n).innerHTML+=", Delivered: "+new Date(e[0].delivered):t(n)},l)},1e3)}(t)},s=function(){var e=u.value,t=r.options[r.selectedIndex].text;o.call("Add",{typeName:"TextMessage",entity:{device:{id:e},messageContent:{isRelayOn:"On"===t,contentType:"IoxOutput"},isDirectionToVehicle:!0}},n,l)},m=function(e,t){return(e=e.name.toLowerCase())===(t=t.name.toLowerCase())?0:t<e?1:-1};return{initialize:function(e,t,n){o=e,i=document.getElementById("ioxOutput"),u=document.getElementById("ioxoutput-vehicles"),d=document.getElementById("ioxoutput-send"),a=document.getElementById("ioxoutput-history"),c=document.getElementById("ioxoutput-error"),r=document.getElementById("ioxoutput-state"),u.addEventListener("change",function(){d.disabled=!1}),d.addEventListener("click",s),n()},focus:function(e,t){(o=e).call("Get",{typeName:"Device",resultsLimit:1e3,search:{fromDate:(new Date).toISOString(),groups:t.getGroupFilter()}},function(e){if(function(){for(var e=u.options.length-1;0<=e;e--)u.remove(e)}(),e&&!(e.length<1)){e.sort(m);for(var t=0;t<e.length;t++){var n=new Option;n.text=e[t].name,n.value=e[t].id,u.add(n)}i.style.display=""}},l)},blur:function(){d.disabled=!0,i.style.display="none"}}};